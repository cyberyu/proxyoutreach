<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Page Blocker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="styles.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <h1>Debug Page Blocker</h1>
        
        <div class="alert alert-warning">
            <h5>üêõ Debug Mode</h5>
            <p>This page helps debug why the page blocker might not be showing.</p>
        </div>
        
        <div class="card">
            <div class="card-header">
                <h5>Debug Tests</h5>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <button class="btn btn-primary" onclick="testBasicBlock()">
                        1. Test Basic Block (5 seconds)
                    </button>
                    
                    <button class="btn btn-info" onclick="testDirectShow()">
                        2. Test Direct Show Blocker
                    </button>
                    
                    <button class="btn btn-warning" onclick="testDebugClass()">
                        3. Test Debug Red Background
                    </button>
                    
                    <button class="btn btn-success" onclick="inspectBlocker()">
                        4. Inspect Blocker Element
                    </button>
                    
                    <button class="btn btn-danger" onclick="forceHide()">
                        5. Force Hide Blocker
                    </button>
                </div>
                
                <hr>
                
                <h6>Console Output:</h6>
                <pre id="debugOutput" class="bg-light p-3" style="height: 200px; overflow-y: auto; font-size: 0.8rem;"></pre>
            </div>
        </div>
    </div>

    <!-- Page Blocker Overlay (from styles.css) -->
    <div id="pageBlocker" class="page-blocker">
        <div class="loading-clock">
            <i class="fas fa-clock"></i>
        </div>
        <div class="loading-message" id="loadingMessage">
            Loading data...<br>
            <small class="text-muted">Please wait, the page will be available when complete</small>
        </div>
    </div>

    <script>
        // Debug logging
        const debugOutput = document.getElementById('debugOutput');
        
        function debugLog(message) {
            const timestamp = new Date().toLocaleTimeString();
            debugOutput.textContent += `[${timestamp}] ${message}\n`;
            debugOutput.scrollTop = debugOutput.scrollHeight;
            console.log(message);
        }
        
        // Initialize blocker
        const blocker = document.getElementById('pageBlocker');
        const message = document.getElementById('loadingMessage');
        let isBlocking = false;
        
        debugLog('üöÄ Debug page loaded');
        debugLog(`Blocker element found: ${!!blocker}`);
        debugLog(`Message element found: ${!!message}`);
        
        if (blocker) {
            debugLog(`Blocker initial classes: ${blocker.className}`);
            debugLog(`Blocker initial display: ${getComputedStyle(blocker).display}`);
            debugLog(`Blocker initial visibility: ${getComputedStyle(blocker).visibility}`);
        }
        
        function testBasicBlock() {
            debugLog('üß™ Testing basic block...');
            
            if (!blocker) {
                debugLog('‚ùå ERROR: No blocker element found!');
                return;
            }
            
            isBlocking = true;
            
            // Update message
            if (message) {
                message.innerHTML = 'Debug test loading...<br><small class="text-muted">Testing for 5 seconds</small>';
            }
            
            // Add loading class to body
            document.body.classList.add('loading-active');
            debugLog('Added loading-active class to body');
            
            // Show blocker
            blocker.classList.add('active');
            debugLog('Added active class to blocker');
            debugLog(`Blocker classes after active: ${blocker.className}`);
            debugLog(`Blocker display after active: ${getComputedStyle(blocker).display}`);
            
            setTimeout(() => {
                isBlocking = false;
                document.body.classList.remove('loading-active');
                blocker.classList.remove('active');
                debugLog('‚úÖ Test complete - blocker hidden');
            }, 5000);
        }
        
        function testDirectShow() {
            debugLog('üîß Testing direct show...');
            
            if (!blocker) {
                debugLog('‚ùå ERROR: No blocker element found!');
                return;
            }
            
            blocker.style.display = 'flex';
            blocker.style.visibility = 'visible';
            blocker.style.opacity = '1';
            blocker.style.zIndex = '99999';
            
            debugLog('Applied direct styles to blocker');
            debugLog(`Blocker computed display: ${getComputedStyle(blocker).display}`);
            
            setTimeout(() => {
                blocker.style.display = 'none';
                debugLog('Hidden blocker with direct styles');
            }, 3000);
        }
        
        function testDebugClass() {
            debugLog('üî¥ Testing debug red background...');
            
            if (!blocker) {
                debugLog('‚ùå ERROR: No blocker element found!');
                return;
            }
            
            blocker.classList.add('debug-visible');
            debugLog('Added debug-visible class');
            debugLog(`Blocker classes: ${blocker.className}`);
            
            setTimeout(() => {
                blocker.classList.remove('debug-visible');
                debugLog('Removed debug-visible class');
            }, 3000);
        }
        
        function inspectBlocker() {
            debugLog('üîç Inspecting blocker element...');
            
            if (!blocker) {
                debugLog('‚ùå ERROR: No blocker element found!');
                return;
            }
            
            const styles = getComputedStyle(blocker);
            debugLog(`Element ID: ${blocker.id}`);
            debugLog(`Classes: ${blocker.className}`);
            debugLog(`Display: ${styles.display}`);
            debugLog(`Position: ${styles.position}`);
            debugLog(`Z-index: ${styles.zIndex}`);
            debugLog(`Visibility: ${styles.visibility}`);
            debugLog(`Opacity: ${styles.opacity}`);
            debugLog(`Top: ${styles.top}`);
            debugLog(`Left: ${styles.left}`);
            debugLog(`Width: ${styles.width}`);
            debugLog(`Height: ${styles.height}`);
            debugLog(`Background: ${styles.background}`);
            
            // Check if it's in the DOM
            debugLog(`In document: ${document.contains(blocker)}`);
            debugLog(`Parent element: ${blocker.parentElement?.tagName || 'none'}`);
        }
        
        function forceHide() {
            debugLog('üö´ Force hiding blocker...');
            
            if (!blocker) {
                debugLog('‚ùå ERROR: No blocker element found!');
                return;
            }
            
            blocker.classList.remove('active', 'debug-visible');
            blocker.style.display = 'none';
            document.body.classList.remove('loading-active');
            isBlocking = false;
            
            debugLog('‚úÖ Blocker force hidden');
        }
        
        // Global functions for console testing
        window.blockPage = function(msg) {
            debugLog(`üîí blockPage called: ${msg}`);
            testBasicBlock();
        };
        
        window.unblockPage = function() {
            debugLog('üîì unblockPage called');
            forceHide();
        };
        
        window.isPageBlocked = function() {
            return isBlocking;
        };
        
        debugLog('‚úÖ Debug functions ready. Try: blockPage("test"), unblockPage()');
    </script>
    
    <!-- Load main script for actual page blocker functionality -->
    <script src="script.js"></script>
</body>
</html>
